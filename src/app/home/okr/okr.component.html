<div class="okr">
  <h1 class="okr__title">
    <ng-container [formGroup]="form">
      <span>Objective(目標) :</span>
      <div class="okr__objective-wrapper">
        <input
          class="okr__objective"
          (keyup)="updateObjective(form.value.Objective)"
          type="text"
          formControlName="objective"
        />
        <mat-error *ngIf="objectiveContoroll.hasError('required')">
          必須入力です。
        </mat-error>
        <mat-error *ngIf="objectiveContoroll.hasError('maxlength')">
          最大文字数は20文字です。
        </mat-error>
      </div>
    </ng-container>
    <button class="okr__icon" mat-icon-button [matMenuTriggerFor]="menu">
      <mat-icon>keyboard_arrow_down</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="deleteOkr()">
        <mat-icon>
          delete
        </mat-icon>
        <span>削除する</span>
      </button>
    </mat-menu>
  </h1>
  <div *ngFor="let primary of primaries$ | async" class="okr__keyResults">
    <p class="okr__content">
      Key Result(目標達成のための成果指標) :
    </p>
    <div class="okr__keyResult-container" [formGroup]="keyResults[primary.id]">
      <ng-container
        *ngFor="let KeyResult of keyResults[primary.id].controls; index as i"
      >
        <div [formGroupName]="i">
          <input
            class="okr__keyResult"
            (keyup)="updateKeyResult(primary.id, keyResults[primary.id].value)"
            type="text"
            formControlName="key"
          />
          <mat-error *ngIf="KeyResult.get('key').hasError('required')">
            必須入力です。
          </mat-error>
          <mat-error *ngIf="KeyResult.get('key').hasError('maxlength')">
            最大文字数は20文字です。
          </mat-error>
        </div>
      </ng-container>
    </div>
  </div>
</div>
