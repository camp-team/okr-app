<div class="main">
  <div class="container">
    <mat-horizontal-stepper #stepper>
      <mat-step
        [stepControl]="firstFormGroup"
        errorMessage="Address is required."
      >
        <form [formGroup]="form">
          <ng-template matStepLabel>目標を入力しましょう(手順 1/3)</ng-template>
          <h2>まず<br />目標を入力しましょう</h2>
          <mat-form-field>
            <mat-label>タイトル</mat-label>
            <input
              formControlName="title"
              type="text"
              matInput
              autocomplete="off"
              required
            />
            <mat-error *ngIf="titleControl.hasError('required')"
              >必須入力です</mat-error
            >
            <mat-error *ngIf="titleControl.hasError('maxlength')"
              >文字数は最大で40文字までです</mat-error
            >
          </mat-form-field>
          <div>
            <button
              mat-button
              matStepperNext
              [disabled]="titleControl.invalid"
              mat-raised-button
              color="primary"
            >
              次へ
            </button>
          </div>
        </form>
      </mat-step>

      <mat-step
        [stepControl]="secondFormGroup"
        errorMessage="Address is required."
      >
        <form [formGroup]="form">
          <ng-template matStepLabel
            >開始日と終了日を入力しましょう(手順 2/3)</ng-template
          >
          <h2>次に<br />開始日終了日を入力しましょう</h2>
          <mat-form-field>
            <mat-label>開始日</mat-label>
            <input
              formControlName="start"
              type="text"
              matInput
              autocomplete="off"
              required
              matInput
              [matDatepicker]="picker"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="picker"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="startControl.hasError('required')"
              >必須入力です</mat-error
            >
          </mat-form-field>
          <mat-form-field>
            <mat-label>終了日</mat-label>
            <input
              formControlName="end"
              type="text"
              matInput
              autocomplete="off"
              required
              matInput
              [matDatepicker]="picker1"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="picker1"
            ></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
            <mat-error *ngIf="endControl.hasError('required')"
              >必須入力です</mat-error
            >
          </mat-form-field>
          <div>
            <button mat-button matStepperPrevious>戻る</button>
            <button
              mat-button
              matStepperNext
              [disabled]="startControl.invalid || endControl.invalid"
              mat-raised-button
              color="primary"
            >
              次へ
            </button>
          </div>
        </form>
      </mat-step>

      <mat-step
        [stepControl]="thirdFormGroup"
        errorMessage="Address is required."
      >
        <form [formGroup]="form" (ngSubmit)="submit()">
          <ng-template matStepLabel
            >コンテンツを入力しましょう(手順 3/3)</ng-template
          >
          <h2>最後に<br />コンテンツを入力しましょう</h2>
          <h3>(入力が終わったら、作成ボタンをクリックしましょう)</h3>

          <div formArrayName="primaries">
            <div *ngFor="let option of primaries.controls; let i = index">
              <mat-form-field>
                <mat-label> primary{{ i + 1 }} </mat-label>
                <input
                  [formControlName]="i"
                  type="text"
                  matInput
                  autocomplete="off"
                />
                <mat-error *ngIf="option.hasError('maxlength')"
                  >文字数は最大で40文字までです</mat-error
                >
              </mat-form-field>
              <button
                class="remcontents"
                type="button"
                (click)="removeOption(i)"
                mat-icon-button
              >
                <mat-icon>remove</mat-icon>
              </button>
            </div>
          </div>

          <button
            class="addcontents"
            type="button"
            mat-raised-button
            (click)="addOptionForm()"
          >
            <mat-icon>add</mat-icon>
            Add contents
          </button>

          <div>
            <button mat-button matStepperPrevious>戻る</button>
            <button [disabled]="form.invalid" mat-raised-button color="primary">
              作成
            </button>
          </div>
        </form>
      </mat-step>
    </mat-horizontal-stepper>
  </div>
</div>
